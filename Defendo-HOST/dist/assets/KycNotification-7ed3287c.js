import{r as u,s as r,j as s}from"./index-221e5e32.js";import{A as y}from"./index-cfdf0eb9.js";import{h as w}from"./motion-cb67fe8f.js";function _(){const[m,h]=u.useState([]),[g,p]=u.useState(!1);u.useEffect(()=>{let e,a;return(async()=>{var f;const{data:i}=await r.auth.getUser(),n=(f=i==null?void 0:i.user)==null?void 0:f.id;n&&(e=r.channel("kyc_status_changes").on("postgres_changes",{event:"UPDATE",schema:"public",table:"host_kyc",filter:`host_id=eq.${n}`},async c=>{if(c.new.status==="approved"){o({type:"success",title:"KYC Approved! ðŸŽ‰",message:"Your KYC documents have been approved by our admin team.",timestamp:new Date().toISOString()});const{data:t}=await r.from("host_kyc").select("status").eq("host_id",n);if(t&&t.length>0){const l=t.map(d=>d.status),v=l.includes("rejected"),j=l.some(d=>d==="pending"||d==="submitted"),b=l.includes("approved");!v&&!j&&b&&o({type:"success",title:"All Documents Approved âœ…",message:"Great news! All your KYC documents are approved. Your account is fully verified.",timestamp:new Date().toISOString()})}}else c.new.status==="rejected"&&o({type:"error",title:"KYC Rejected",message:c.new.rejection_reason||"Your KYC documents have been rejected. Please review and resubmit.",timestamp:new Date().toISOString()})}).subscribe(),a=r.channel("host_notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${n}`},c=>{const t=c.new||{},l=(t.type||"").includes("verification")&&(t.title||"").toLowerCase().includes("verified");o({type:l?"success":"info",title:t.title||"Notification",message:t.message||"",timestamp:t.created_at||new Date().toISOString()})}).subscribe())})(),()=>{e&&r.removeChannel(e),a&&r.removeChannel(a)}},[]);const o=e=>{const a=Date.now();h(n=>[...n,{...e,id:a}]),p(!0);const i=setTimeout(()=>{x(a)},5e3);return()=>clearTimeout(i)},x=e=>{h(a=>a.filter(i=>i.id!==e)),m.length===1&&p(!1)};return!g||m.length===0?null:s.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:s.jsx(y,{children:m.map(e=>s.jsx(w.div,{initial:{opacity:0,x:300,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.8},transition:{duration:.3,ease:"easeOut"},className:`max-w-sm bg-white rounded-lg shadow-lg border-l-4 p-4 ${e.type==="success"?"border-green-500 bg-green-50":"border-red-500 bg-red-50"}`,children:s.jsxs("div",{className:"flex items-start",children:[s.jsx("div",{className:"flex-shrink-0",children:e.type==="success"?s.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white text-sm",children:"âœ“"})}):s.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white text-sm",children:"âœ•"})})}),s.jsxs("div",{className:"ml-3 flex-1",children:[s.jsx("h4",{className:`text-sm font-medium ${e.type==="success"?"text-green-800":"text-red-800"}`,children:e.title}),s.jsx("p",{className:`text-sm mt-1 ${e.type==="success"?"text-green-700":"text-red-700"}`,children:e.message}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(e.timestamp).toLocaleTimeString()})]}),s.jsxs("button",{onClick:()=>x(e.id),className:"ml-2 flex-shrink-0 text-gray-400 hover:text-gray-600",children:[s.jsx("span",{className:"sr-only",children:"Close"}),s.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]})},e.id))})})}export{_ as default};
